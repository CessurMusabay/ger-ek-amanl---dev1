 public class ReadersWriters { private static int readers = 0; private static int waitingWriters = 0; private static boolean writing = false; public synchronized void StartWrite() throws InterruptedException { while (readers > 0 || writing) { waitingWriters++; wait(); waitingWriters--; } writing = true; } public synchronized void StopWrite() { writing = false; notifyAll(); } public synchronized void StartRead() throws InterruptedException { while (writing || waitingWriters > 0) { wait(); } readers++; } public synchronized void StopRead() { readers--; if (readers == 0) { notifyAll(); } } public static void main(String[] args) { ReadersWriters w=new ReadersWriters(); ReadersWriters y=new ReadersWriters(); try{ w.StartWrite(); w.StopWrite(); w.StartRead(); y.StartRead(); y.StopRead(); w.StopRead(); y.StartWrite(); y.StopWrite(); }catch(Exception e){ System.out.println(e); } } }
